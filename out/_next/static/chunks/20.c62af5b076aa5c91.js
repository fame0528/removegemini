"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[20],{5689:(e,t,r)=>{r.r(t),r.d(t,{default:()=>w});var s=r(5155),a=r(2115);let n={"en-US":JSON.parse('{"title":"Gemini Watermark Remover - Lossless Watermark Removal Tool","header.title":"Gemini Watermark Remover","nav.userscript":"Install Userscript for Gemini","nav.principle":"How It Works?","main.title":"Gemini AI Watermark Removal","main.subtitle":"Based on reverse alpha blending algorithm, pure browser-side processing, Free, Fast, and Lossless","upload.text":"Click to select or drag images here","upload.hint":"Supports JPG, PNG, WebP","step.1":"Select Original Image","step.2":"Auto Processing","step.3":"Save Clean Image","preview.original":"Original Preview","preview.result":"Processed Result","panel.title":"Control Panel","btn.download":"Download","btn.reset":"Reset / Change Image","progress.text":"Progress","btn.downloadAll":"Download All","feature.title":"Features","feature.speed.title":"Lightning Fast","feature.speed.desc":"Based on modern browser technologies, millisecond response, no waiting queue","feature.privacy.title":"Privacy First","feature.privacy.desc":"Pure frontend processing, images never leave your device","feature.free.title":"Completely Free","feature.free.desc":"No usage limits, no hidden fees, ready to use","footer.desc":"Gemini Watermark Remover, for educational purposes only","footer.links":"Links","footer.terms":"Terms of Use","footer.github":"GitHub","footer.tech":"Technology","footer.copyright":"\xa9 {{year}} Gemini Watermark Remover. All rights reserved.","loading.text":"Processing...","status.loading":"Loading resources...","status.pending":"Pending...","status.processing":"Processing...","status.success":"Completed","status.failed":"Failed","info.size":"Size","info.watermark":"Detected Watermark","info.position":"Position","info.status":"Status","info.removed":"Watermark Removed","original.not_gemini":"⚠️ This image may not be made with Gemini. Lossless processing unavailable.","original.not_original":"⚠️ This image may not be original size. Lossless processing unavailable.","original.pass":"✅ This image made with Gemini. Lossless processing supported."}'),"zh-CN":JSON.parse('{"title":"Gemini Watermark Remover - Gemini 无损去水印工具","header.title":"Gemini Watermark Remover","nav.userscript":"安装油猴脚本","nav.principle":"去水印原理","main.title":"Gemini AI 图像去水印","main.subtitle":"基于反向 Alpha 混合算法，纯浏览器本地处理，免费、极速、无损","upload.text":"点击选择 或 拖拽图片至此","upload.hint":"支持 JPG, PNG, WebP","step.1":"选择原始图片","step.2":"算法自动解析","step.3":"保存无水印图","preview.original":"原图预览","preview.result":"处理结果","panel.title":"操作面板","btn.download":"下载结果","btn.reset":"重置 / 更换图片","progress.text":"处理进度","btn.downloadAll":"全部下载","feature.title":"功能特点","feature.speed.title":"极速处理","feature.speed.desc":"基于现代浏览器技术加速处理，毫秒级响应，无需等待排队","feature.privacy.title":"隐私安全","feature.privacy.desc":"浏览器前端本地运行，图片数据不会离开您的设备，绝不会上传服务器","feature.free.title":"完全免费","feature.free.desc":"无次数限制，无隐藏付费，即开即用","footer.desc":"Gemini 无损去水印工具，本工具仅供学习交流使用","footer.links":"链接","footer.terms":"使用条款","footer.github":"GitHub","footer.tech":"技术","footer.copyright":"\xa9 {{year}} Gemini Watermark Remover. All rights reserved.","loading.text":"正在处理...","status.loading":"正在加载资源...","status.pending":"等待处理...","status.processing":"处理中...","status.success":"处理完成","status.failed":"处理失败","info.size":"尺寸","info.watermark":"检测到的水印","info.position":"位置","info.status":"状态","info.removed":"水印已移除","original.not_gemini":"⚠️ 此图片非 Gemini 生成的原始图片，可能无法进行无损去水印","original.not_original":"⚠️ 此图片非原始尺寸，可能无法进行无损去水印","original.pass":"✅ 此图片为 Gemini 生成的原始图片，可进行无损去水印"}')},i=function(e){let t=function(){let e=navigator.language;return"zh-CN"===e||"zh"===e?"zh-CN":"en-US"}(),r=[];return{t:function(e,r){let s=n[t][e]||e;return r&&Object.entries(r).forEach(e=>{let[t,r]=e;s=s.replace(RegExp("{{".concat(t,"}}"),"g"),String(r))}),s},setLocale:function(e){t!==e&&(t=e,r.forEach(t=>t(e)))},getLocale:function(){return t},onChange:function(e){return r.push(e),()=>{let t=r.indexOf(e);-1!==t&&r.splice(t,1)}}}}();function l(){let[e,t]=(0,a.useState)(i.getLocale()),[r,n]=(0,a.useState)(i.t("header.title"));return(0,a.useEffect)(()=>i.onChange(e=>{t(e),n(i.t("header.title"))}),[]),(0,s.jsx)("header",{className:"fixed top-0 left-0 right-0 z-50 bg-white border-b border-gray-200 shadow-sm",children:(0,s.jsx)("div",{className:"container mx-auto px-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between h-16",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg flex items-center justify-center",children:(0,s.jsx)("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),(0,s.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:r})]}),(0,s.jsxs)("button",{onClick:()=>{i.setLocale("en-US"===e?"zh-CN":"en-US")},className:"flex items-center space-x-2 px-4 py-2 rounded-lg bg-gray-100 hover:bg-gray-200 transition-colors","aria-label":"Toggle language",children:[(0,s.jsx)("svg",{className:"w-5 h-5 text-gray-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5h12M9 3v2m1.048 9.5A18.022 18.022 0 016.412 9m6.088 9h7M11 21l5-10 5 10M12.751 5C11.783 10.77 8.07 15.61 3 18.129"})}),(0,s.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"en-US"===e?"EN":"中文"})]})]})})})}function o(){let[e,t]=(0,a.useState)(i.t("footer.desc")),[r,n]=(0,a.useState)(i.t("footer.copyright",{year:new Date().getFullYear().toString()}));return(0,a.useEffect)(()=>i.onChange(()=>{t(i.t("footer.desc")),n(i.t("footer.copyright",{year:new Date().getFullYear().toString()}))}),[]),(0,s.jsx)("footer",{className:"bg-gray-50 border-t border-gray-200 mt-16",children:(0,s.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-semibold text-gray-900 mb-3",children:"Gemini Watermark Remover"}),(0,s.jsx)("p",{className:"text-sm text-gray-600 leading-relaxed",children:e})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-semibold text-gray-900 mb-3",children:i.t("footer.links")}),(0,s.jsxs)("ul",{className:"space-y-2",children:[(0,s.jsx)("li",{children:(0,s.jsx)("a",{href:"https://github.com",target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-800 hover:underline",children:i.t("footer.github")})}),(0,s.jsx)("li",{children:(0,s.jsx)("a",{href:"/terms.html",className:"text-sm text-blue-600 hover:text-blue-800 hover:underline",children:i.t("footer.terms")})})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-semibold text-gray-900 mb-3",children:i.t("footer.tech")}),(0,s.jsxs)("ul",{className:"space-y-2 text-sm text-gray-600",children:[(0,s.jsxs)("li",{children:["✅ ",i.t("feature.privacy.title")]}),(0,s.jsxs)("li",{children:["⚡ ",i.t("feature.speed.title")]}),(0,s.jsxs)("li",{children:["\uD83C\uDD93 ",i.t("feature.free.title")]})]})]})]}),(0,s.jsx)("div",{className:"mt-8 pt-6 border-t border-gray-200",children:(0,s.jsx)("p",{className:"text-sm text-center text-gray-500",children:r})})]})})}function c(e){let{onFilesSelected:t,disabled:r=!1}=e,[n,l]=(0,a.useState)(!1),o=(0,a.useRef)(null);return(0,s.jsxs)("div",{className:"\n        relative border-2 border-dashed rounded-xl p-12\n        transition-all duration-200 cursor-pointer\n        ".concat(n?"border-blue-500 bg-blue-50":r?"border-gray-200 bg-gray-50 cursor-not-allowed":"border-gray-300 bg-gray-50 hover:border-blue-400 hover:bg-blue-50","\n      "),onDragEnter:e=>{e.preventDefault(),e.stopPropagation(),r||l(!0)},onDragLeave:e=>{e.preventDefault(),e.stopPropagation(),l(!1)},onDragOver:e=>{e.preventDefault(),e.stopPropagation()},onDrop:e=>{if(e.preventDefault(),e.stopPropagation(),l(!1),r)return;let s=e.dataTransfer.files;s.length>0&&t(s)},onClick:()=>{!r&&o.current&&o.current.click()},children:[(0,s.jsx)("input",{ref:o,type:"file",accept:"image/*",multiple:!0,onChange:e=>{let r=e.target.files;r&&r.length>0&&t(r),e.target.value=""},className:"hidden",disabled:r}),(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center space-y-4",children:[(0,s.jsx)("div",{className:"\n            w-16 h-16 rounded-full flex items-center justify-center\n            ".concat(n?"bg-blue-100":"bg-gray-200","\n          "),children:(0,s.jsx)("svg",{className:"w-8 h-8 ".concat(n?"text-blue-600":"text-gray-500"),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})})}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("p",{className:"text-lg font-medium text-gray-700",children:i.t("upload.text")}),(0,s.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:i.t("upload.hint")})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-6 mt-6",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("div",{className:"w-8 h-8 rounded-full bg-blue-500 text-white flex items-center justify-center text-sm font-bold",children:"1"}),(0,s.jsx)("span",{className:"text-sm text-gray-600",children:i.t("step.1")})]}),(0,s.jsx)("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("div",{className:"w-8 h-8 rounded-full bg-blue-500 text-white flex items-center justify-center text-sm font-bold",children:"2"}),(0,s.jsx)("span",{className:"text-sm text-gray-600",children:i.t("step.2")})]}),(0,s.jsx)("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("div",{className:"w-8 h-8 rounded-full bg-blue-500 text-white flex items-center justify-center text-sm font-bold",children:"3"}),(0,s.jsx)("span",{className:"text-sm text-gray-600",children:i.t("step.3")})]})]})]})]})}var d=r(5169);function m(e){let t,r,{item:n,onRemoveWatermark:l,onDownload:o}=e,c=(0,a.useRef)(null),m=(0,a.useRef)(null);(0,a.useEffect)(()=>{c.current&&(0,d.A)(c.current,{background:"rgba(0, 0, 0, 0.8)",margin:24}),m.current&&n.processedUrl&&(0,d.A)(m.current,{background:"rgba(0, 0, 0, 0.8)",margin:24})},[n.processedUrl]);let u=n.isOriginal?{text:i.t("original.pass"),color:"text-green-600 bg-green-50"}:{text:i.t("original.not_original"),color:"text-yellow-600 bg-yellow-50"};return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-4",children:i.t("panel.title")}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:i.t("info.size")}),(0,s.jsx)("p",{className:"text-base font-medium",children:(t=n.originalImage.width,r=n.originalImage.height,"".concat(t," \xd7 ").concat(r))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:i.t("info.watermark")}),(0,s.jsxs)("p",{className:"text-base font-medium",children:[n.watermarkInfo.size," \xd7 ",n.watermarkInfo.size]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:i.t("info.status")}),(0,s.jsx)("span",{className:"inline-block px-2 py-1 rounded text-sm font-medium ".concat((e=>{switch(e){case"success":return"text-green-600 bg-green-50";case"processing":return"text-blue-600 bg-blue-50";case"failed":return"text-red-600 bg-red-50";default:return"text-gray-600 bg-gray-50"}})(n.status)),children:(e=>{switch(e){case"success":return i.t("status.success");case"processing":return i.t("status.processing");case"failed":return i.t("status.failed");default:return i.t("status.pending")}})(n.status)})]})]}),(0,s.jsx)("div",{className:"p-3 rounded-lg ".concat(u.color," mb-4"),children:(0,s.jsx)("p",{className:"text-sm",children:u.text})}),(0,s.jsxs)("div",{className:"flex space-x-3",children:["pending"===n.status&&(0,s.jsx)("button",{onClick:l,className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg transition-colors",children:i.t("info.removed")}),"processing"===n.status&&(0,s.jsxs)("button",{disabled:!0,className:"flex-1 bg-blue-400 text-white font-medium py-2 px-4 rounded-lg cursor-not-allowed flex items-center justify-center",children:[(0,s.jsxs)("svg",{className:"animate-spin h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),i.t("loading.text")]}),"success"===n.status&&(0,s.jsx)("button",{onClick:o,className:"flex-1 bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded-lg transition-colors",children:i.t("btn.download")})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4",children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:i.t("preview.original")}),(0,s.jsx)("div",{className:"relative aspect-square bg-gray-100 rounded-lg overflow-hidden",children:(0,s.jsx)("img",{ref:c,src:n.originalUrl||"",alt:"Original",className:"w-full h-full object-contain cursor-zoom-in"})})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4",children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:i.t("preview.result")}),(0,s.jsx)("div",{className:"relative aspect-square bg-gray-100 rounded-lg overflow-hidden",children:n.processedUrl?(0,s.jsx)("img",{ref:m,src:n.processedUrl,alt:"Processed",className:"w-full h-full object-contain cursor-zoom-in"}):(0,s.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,s.jsx)("p",{className:"text-gray-400 text-sm",children:i.t("status.pending")})})})]})]})]})}let u=r.p+"static/media/bg_48.192661aa8c4d9f38.png",g=r.p+"static/media/bg_96.11e19edfd0100d81.png";function h(e,t){return e>1024&&t>1024?{logoSize:96,marginRight:64,marginBottom:64}:{logoSize:48,marginRight:32,marginBottom:32}}function x(e,t,r){let{logoSize:s,marginRight:a,marginBottom:n}=r;return{x:e-a-s,y:t-n-s,width:s,height:s}}class p{static async create(){let e=new Image,t=new Image;return await Promise.all([new Promise((t,r)=>{e.onload=()=>t(),e.onerror=r,e.src=u.src}),new Promise((e,r)=>{t.onload=()=>e(),t.onerror=r,t.src=g.src})]),new p({bg48:e,bg96:t})}async getAlphaMap(e){if(this.alphaMaps[e])return this.alphaMaps[e];let t=48===e?this.bgCaptures.bg48:this.bgCaptures.bg96,r=document.createElement("canvas");r.width=e,r.height=e;let s=r.getContext("2d");s.drawImage(t,0,0);let a=function(e){let{width:t,height:r,data:s}=e,a=new Float32Array(t*r);for(let e=0;e<a.length;e++){let t=4*e,r=s[t],n=Math.max(r,s[t+1],s[t+2]);a[e]=n/255}return a}(s.getImageData(0,0,e,e));return this.alphaMaps[e]=a,a}async removeWatermarkFromImage(e){let t=document.createElement("canvas");t.width=e.width,t.height=e.height;let r=t.getContext("2d");r.drawImage(e,0,0);let s=r.getImageData(0,0,t.width,t.height),a=h(t.width,t.height),n=x(t.width,t.height,a);return!function(e,t,r){let{x:s,y:a,width:n,height:i}=r;for(let r=0;r<i;r++)for(let i=0;i<n;i++){let l=((a+r)*e.width+(s+i))*4,o=t[r*n+i];if(o<.002)continue;let c=1-(o=Math.min(o,.99));for(let t=0;t<3;t++){let r=(e.data[l+t]-255*o)/c;e.data[l+t]=Math.max(0,Math.min(255,Math.round(r)))}}}(s,await this.getAlphaMap(a.logoSize),n),r.putImageData(s,0,0),t}getWatermarkInfo(e,t){let r=h(e,t),s=x(e,t,r);return{size:r.logoSize,position:s,config:r}}constructor(e){this.bgCaptures=e,this.alphaMaps={48:null,96:null}}}var f=r(7573);async function b(e){return new Promise((t,r)=>{let s=new Image;s.onload=()=>t(s),s.onerror=r,s.src=URL.createObjectURL(e)})}async function v(e){try{var t,r,s;let a=await f.Ay.parse(e,{tiff:!0,xmp:!0,icc:!1,iptc:!1,jfif:!1,ihdr:!1,translateKeys:!1,translateValues:!1,reviveValues:!1,sanitize:!1,mergeOutput:!1});if(!a)return!0;let n=(null==(t=a.Software)?void 0:t.toLowerCase())||"",i=(null==(r=a.UserComment)?void 0:r.toLowerCase())||"",l=(null==(s=a.ImageDescription)?void 0:s.toLowerCase())||"";for(let e of["gemini","imagen","dalle","midjourney","stable diffusion"])if(n.includes(e)||i.includes(e)||l.includes(e))return!1;return!0}catch(e){return console.warn("EXIF parsing failed:",e),!0}}async function j(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"image/png",s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.95;return new Promise((a,n)=>{e.toBlob(e=>{if(!e)return void n(Error("Failed to create blob from canvas"));let r=URL.createObjectURL(e),s=document.createElement("a");s.href=r,s.download=t,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(r),a()},r,s)})}function w(){let{isLoading:e,imageQueue:t,currentIndex:r,processFiles:n,removeWatermark:d,downloadImage:u,downloadAll:g,reset:h,setCurrentIndex:x}=function(){let[e,t]=(0,a.useState)(null),[r,s]=(0,a.useState)(!0),[n,i]=(0,a.useState)([]),[l,o]=(0,a.useState)(0),c=(0,a.useRef)(new Map);(0,a.useEffect)(()=>{(async()=>{try{s(!0);let e=await p.create();t(e)}catch(e){console.error("Failed to initialize watermark engine:",e)}finally{s(!1)}})()},[]);let d=(0,a.useCallback)(async t=>{if(e){s(!0);try{let r=Array.from(t),s=[];for(let t=0;t<r.length;t++){let a=r[t];if(!a.type.startsWith("image/")){console.warn("Skipping non-image file: ".concat(a.name));continue}let n=await b(a),i=await v(a),l=e.getWatermarkInfo(n.width,n.height),o=URL.createObjectURL(a);s.push({id:Date.now()+t,file:a,name:a.name,originalImage:n,originalImg:n,originalUrl:o,processedCanvas:null,processedUrl:null,processedBlob:null,status:"pending",isOriginal:i,watermarkInfo:l})}i(e=>[...e,...s])}catch(e){console.error("Error processing files:",e)}finally{s(!1)}}},[e]),m=(0,a.useCallback)(async t=>{if(!e||t<0||t>=n.length)return;let r=n[t];if("processing"!==r.status&&"success"!==r.status){i(e=>{let r=[...e];return r[t]={...r[t],status:"processing"},r});try{let s=await e.removeWatermarkFromImage(r.originalImage);c.current.set(t,s);let a=await new Promise((e,t)=>{s.toBlob(r=>{r?e(r):t(Error("Failed to create blob"))},"image/png")}),n=URL.createObjectURL(a);i(e=>{let r=[...e];return r[t]={...r[t],processedCanvas:s,processedUrl:n,status:"success"},r})}catch(e){console.error("Error removing watermark:",e),i(e=>{let r=[...e];return r[t]={...r[t],status:"failed"},r})}}},[e,n]),u=(0,a.useCallback)(e=>{if(e<0||e>=n.length)return;let t=n[e];if(!t.processedCanvas)return;let r=t.file.name,s={"image/png":"png","image/jpeg":"jpg","image/jpg":"jpg","image/webp":"webp","image/gif":"gif","image/bmp":"bmp"}[t.file.type]||"png",a=r.replace(/\.[^.]+$/,""),i="".concat(a,"_no_watermark.").concat(s);j(t.processedCanvas,i,t.file.type)},[n]),g=(0,a.useCallback)(()=>{n.forEach((e,t)=>{e.processedCanvas&&u(t)})},[n,u]),h=(0,a.useCallback)(()=>{n.forEach(e=>{e.originalUrl&&URL.revokeObjectURL(e.originalUrl),e.processedUrl&&URL.revokeObjectURL(e.processedUrl)}),c.current.clear(),i([]),o(0)},[n]);return{engine:e,isLoading:r,imageQueue:n,currentIndex:l,processFiles:d,removeWatermark:m,downloadImage:u,downloadAll:g,reset:h,setCurrentIndex:o}}(),[f,w]=(0,a.useState)(i.t("main.title")),[y,N]=(0,a.useState)(i.t("main.subtitle"));(0,a.useEffect)(()=>i.onChange(()=>{w(i.t("main.title")),N(i.t("main.subtitle"))}),[]);let k=async e=>{await n(e)},C=async e=>{await d(e)},L=t[r],R=t.some(e=>e.processedUrl);return(0,s.jsxs)("div",{className:"min-h-screen flex flex-col bg-gradient-to-br from-gray-50 to-blue-50",children:[(0,s.jsx)(l,{}),(0,s.jsxs)("main",{className:"flex-grow container mx-auto px-4 pt-24 pb-12",children:[(0,s.jsxs)("div",{className:"text-center mb-12",children:[(0,s.jsx)("h2",{className:"text-4xl md:text-5xl font-bold text-gray-900 mb-4",children:f}),(0,s.jsx)("p",{className:"text-lg md:text-xl text-gray-600 max-w-3xl mx-auto",children:y})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-12",children:[(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-6",children:[(0,s.jsx)("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center mb-4",children:(0,s.jsx)("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),(0,s.jsx)("h3",{className:"text-lg font-semibold mb-2",children:i.t("feature.speed.title")}),(0,s.jsx)("p",{className:"text-gray-600 text-sm",children:i.t("feature.speed.desc")})]}),(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-6",children:[(0,s.jsx)("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center mb-4",children:(0,s.jsx)("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),(0,s.jsx)("h3",{className:"text-lg font-semibold mb-2",children:i.t("feature.privacy.title")}),(0,s.jsx)("p",{className:"text-gray-600 text-sm",children:i.t("feature.privacy.desc")})]}),(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-6",children:[(0,s.jsx)("div",{className:"w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center mb-4",children:(0,s.jsx)("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,s.jsx)("h3",{className:"text-lg font-semibold mb-2",children:i.t("feature.free.title")}),(0,s.jsx)("p",{className:"text-gray-600 text-sm",children:i.t("feature.free.desc")})]})]}),e&&0===t.length?(0,s.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsxs)("svg",{className:"animate-spin h-12 w-12 mx-auto mb-4 text-blue-600",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,s.jsx)("p",{className:"text-gray-600",children:i.t("status.loading")})]})}):0===t.length?(0,s.jsx)(c,{onFilesSelected:k,disabled:e}):(0,s.jsxs)("div",{children:[t.length>1&&(0,s.jsx)("div",{className:"mb-6 flex items-center space-x-4 overflow-x-auto pb-4",children:t.map((e,t)=>(0,s.jsxs)("button",{onClick:()=>x(t),className:"\n                      relative flex-shrink-0 w-24 h-24 rounded-lg overflow-hidden\n                      border-2 transition-all\n                      ".concat(t===r?"border-blue-500 shadow-lg":"border-gray-200 hover:border-blue-300","\n                    "),children:[(0,s.jsx)("img",{src:e.originalUrl||"",alt:"Thumbnail ".concat(t+1),className:"w-full h-full object-cover"}),e.processedUrl&&(0,s.jsx)("div",{className:"absolute top-1 right-1 w-4 h-4 bg-green-500 rounded-full border-2 border-white"})]},t))}),L&&(0,s.jsx)(m,{item:L,onRemoveWatermark:()=>C(r),onDownload:()=>{u(r)}}),(0,s.jsxs)("div",{className:"mt-6 flex justify-center space-x-4",children:[(0,s.jsx)("button",{onClick:()=>{h()},className:"px-6 py-3 bg-gray-600 hover:bg-gray-700 text-white font-medium rounded-lg transition-colors",children:i.t("btn.reset")}),R&&(0,s.jsx)("button",{onClick:()=>{g()},className:"px-6 py-3 bg-green-600 hover:bg-green-700 text-white font-medium rounded-lg transition-colors",children:i.t("btn.downloadAll")})]})]})]}),(0,s.jsx)(o,{})]})}}}]);